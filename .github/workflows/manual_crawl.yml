name: Manual News Crawler

# 수동 실행 + 매시간 자동 실행
on:
  workflow_dispatch: # 수동 실행 가능
  schedule:
    - cron: "50 14 * * *" # 매일 오후 11시 50분 (KST) = 14:50 (UTC)

jobs:
  crawl:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install dependencies
        run: |
          pip install -r requirements.txt

      - name: Run crawler
        env:
          SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
          SUPABASE_KEY: ${{ secrets.SUPABASE_KEY }}
          DISCORD_WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK_URL }}
          WEBSITE_URL: ${{ secrets.WEBSITE_URL }}
        run: |
          python crawler.py
